# rkdb

Avro binding for kdb+ using Rust.

## Building for Embedding

```
~/krak(master âœ—) cargo build --release && cp target/release/libkrak.dylib ${QHOME}/m64/libkrak.so
```

Usage from q

```
q)encode: `libkrak 2:(`encode_table;2)
q)decode: `libkrak 2:(`decode_table;1)
q)
q)t:([]sid:10?100i; sym:string 10?`2;price:10?10f;size:10?100)
q)t
sid sym  price     size
-----------------------
77  "ci" 0.8388858 12
30  "hk" 1.959907  10
17  "ae" 3.75638   1
23  "bl" 6.137452  90
12  "oo" 5.294808  73
66  "jg" 6.916099  90
36  "cf" 2.296615  43
37  "bp" 6.919531  90
44  "ic" 4.707883  84
28  "in" 6.346716  63
q)
q)x:encode[t; `int$count t]
q)x
0x4f626a0104146176726f2e636f6465630e6465666c617465166176726f2e736368656d61ca027b2274797065223a227265636f7264222c226e616d65223a227472616465222c226669656c6473223a5b7b226e616d65223a22736964222c2274797065223a22696e74227d2c7b226e616d65223a2273796d222c2274797065223a22737472696e67227d2c7b226e616d65223a227072696365222c2274797065223a22646f75626c65227d2c7b226e616d65223a2273697a65222c2274797065223a226c6f6e67227d5d7d007102106f87ff7a03dbaf0e1ca8ea134114b40215ca310b01611807f0ff7b3d0303497775b2c8f25a980dea9e513e809441ee0df72267530693d1240b9351caa06c96dbf800061b9dcd97e06efefd76829406d894cfaf63d7c81b01c1f9d6fe396691ba3de0fdc9a4d26c54c81d032519ac6cbe089b7c3f7a5658b6782d96828603e07eb58ef908eba4fa40219c750c6e36c89d02fbf9f614538bb40212f2f5c8f24154494f006f9354395efc017102106f87ff7a03dbaf0e1ca8ea1341
q)
q)decode[x]
sid sym  price     size
-----------------------
77  "ci" 0.8388858 12
30  "hk" 1.959907  10
17  "ae" 3.75638   1
23  "bl" 6.137452  90
12  "oo" 5.294808  73
66  "jg" 6.916099  90
36  "cf" 2.296615  43
37  "bp" 6.919531  90
44  "ic" 4.707883  84
28  "in" 6.346716  63
q)
q)t ~ decode[x]
1b
```
